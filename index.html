<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Holy Tuna | Game Portal</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script>
        tailwind.config = {
            theme: {
                extend: {
                    colors: {
                        'primary': '#6366f1', // Indigo 500
                        'secondary': '#f472b6', // Pink 400
                        'dark-bg': '#111827', // Gray 900
                        'card-bg': '#1f2937', // Gray 800
                    },
                },
                fontFamily: {
                    sans: ['Inter', 'sans-serif'],
                },
            }
        }
    </script>
    <style>
        /* Custom scrollbar for a sleek dark-mode look */
        body::-webkit-scrollbar {
            width: 8px;
        }
        body::-webkit-scrollbar-thumb {
            background-color: #6366f1; /* Primary color */
            border-radius: 4px;
        }
        body::-webkit-scrollbar-track {
            background-color: #1f2937; /* Card background color */
        }
        /* Define the collapsed state using a utility class */
        .collapsible-container.collapsed {
            max-height: 0 !important;
            padding-top: 0 !important; /* New: remove top padding */
            padding-bottom: 0 !important; /* Ensure no residual padding pushes height */
        }
    </style>
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css" rel="stylesheet">
</head>
<body class="bg-dark-bg text-gray-100 font-sans min-h-screen pb-12">

    <header id="main-header" class="bg-card-bg shadow-xl sticky top-0 z-20">
        <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 pt-4 pb-2">
            
            <div id="collapsible-content" class="collapsible-container transition-all duration-500 ease-in-out overflow-hidden" style="max-height: 600px; padding-bottom: 1.5rem;">
                
                <div class="flex flex-col items-center pt-4 pb-6">
                    <h1 class="text-6xl font-extrabold text-center tracking-tighter mb-2">
                        <span class="text-primary">Holy</span> <span class="text-secondary">Tuna</span>
                    </h1>
                    <p class="text-center text-gray-400 text-xl font-light">
                        Dive into some of our games or tools!
                    </p>
                </div>

                <div class="flex justify-center items-center gap-4 mb-4">
                    <a href="calc.html" class="inline-block px-4 py-2 bg-secondary rounded-xl text-white font-bold text-base transition duration-150 shadow-lg transform hover:scale-[1.02] **hover:opacity-75**">
                        <i class="fa-solid fa-calculator mr-2"></i> Calculator Tool
                    </a>
                    
                    <a href="music.html" class="inline-block px-4 py-2 bg-primary rounded-xl text-white font-bold text-base transition duration-150 shadow-lg transform hover:scale-[1.02] **hover:opacity-75**">
                        <i class="fa-brands fa-youtube mr-2"></i> Music Tool
                    </a>

                    <a href="history.html" class="inline-block px-4 py-2 bg-dark-bg rounded-xl text-white font-bold text-base transition duration-150 shadow-lg transform hover:scale-[1.02] **hover:opacity-75**">
                        <i class="fa-solid fa-user-secret mr-2"></i> History
                    </a>
                    
                    <a href="#" id="blank-link" class="inline-block px-4 py-2 bg-dark-bg rounded-xl text-white font-bold text-base transition duration-150 shadow-lg transform hover:scale-[1.02] **hover:opacity-75**">
                     <i class="fa-solid fa-user-secret mr-2"></i> Cloak
                    </a>

                    </div>

                <div class="max-w-xl mx-auto mb-6">
                    <div class="relative">
                        <i class="fa-solid fa-search absolute left-4 top-1/2 transform -translate-y-1/2 text-gray-400"></i>
                        <input 
                            type="text" 
                            id="search-input" 
                            placeholder="Search games by title..." 
                            class="w-full pl-12 pr-4 py-3 bg-dark-bg text-white rounded-full border border-gray-700 focus:border-primary focus:ring-1 focus:ring-primary transition duration-150 shadow-inner"
                            aria-label="Search games"
                        >
                    </div>
                </div>
                
                <div id="filter-container" class="flex flex-wrap justify-center gap-3 pt-4 border-t border-gray-700">
                    </div>
            </div>
            
            <div class="text-center pt-3 border-t border-gray-700">
                <button id="collapse-toggle" class="text-primary hover:text-secondary transition duration-150 p-2 rounded-full hover:bg-dark-bg/50" aria-label="Toggle Header Collapse">
                    <i id="collapse-icon" class="fa-solid fa-chevron-up text-xl transform transition-transform duration-500"></i>
                </button>
            </div>
        </div>
    </header>

    <main class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 mt-12">
        <h2 class="text-3xl font-bold text-white mb-8 pb-2">Games List</h2>
        
        <div id="game-list" class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-8">
            </div>

        <div id="no-results" class="hidden text-center mt-16 p-8 bg-card-bg rounded-xl border border-gray-700">
            <i class="fa-solid fa-gamepad text-5xl text-secondary mb-4"></i>
            <h3 class="text-2xl font-bold text-white">No Matching Games Found</h3>
            <p class="text-gray-400 mt-2">Try adjusting your search terms or selecting 'All' categories.</p>
        </div>
    </main>

    <footer class="mt-20 py-6 border-t border-gray-700 text-center text-gray-500 text-sm">
        Other sites - Holy Salmon: holy-salmon-six.vercel.app | Holy Bass: holy-bass.vercel.app/
    </footer>

    <script>
        // Mock JSON data for games
        const gamesData = [
            { title: "Minecraft", category: "Sandbox", image: "https://image.api.playstation.com/vulcan/ap/rnd/202407/1020/91fe046f742042e3b31e57f7731dbe2226e1fd1e02a36223.jpg", link: "/gameview/eaglercraft112.html" },
            { title: "Undertale Yellow", category: "Arcade", image: "https://i.ytimg.com/vi/7BQrbHOJI0k/maxresdefault.jpg", link: "/gameview/undertaleyellow.html" },
            { title: "Geometry Dash Lite", category: "Platformer", image: "https://www.pcgamesn.com/wp-content/sites/pcgamesn/2023/12/geometry-dash-2-2-steam.jpg", link: "/gameview/geometrydashlite.html" },
            { title: "Angry Birds", category: "Puzzle", image: "https://occ-0-8407-116.1.nflxso.net/dnm/api/v6/Z-WHgqd_TeJxSuha8aZ5WpyLcX8/AAAABZICjjBImAL9liWpfCb1MB-vnp8KJE4dIuTuAh7VtOTY4ZmoFGgglulycZ47ElB4qVG5gwAzEKPRSiqDJFtPsNRrqDN1SsTqAVoU.jpg", link: "/gameview/angrybirds.html" },
            { title: "Small World Cup", category: "Sports", image: "https://play-lh.googleusercontent.com/jQCsMmB9NE40JzNf2ie0RP23uI-pvpVfJ6VaJQUD117ScQrmB1jVW8G26jwk0RzkO-0=w526-h296-rw", link: "/gameview/smallworldcup.html" },
            { title: "Slope", category: "Arcade", image: "https://play-lh.googleusercontent.com/FY9FXA14xl5ExZDiLqxEQRUFu8Lau0gM37zMRK5yFk_cadt_a3i5romTW-kbFlk-RQI=w526-h296-rw", link: "/gameview/slope.html" },
            { title: "Baldi's Basics", category: "Puzzle", image: "https://images.squarespace-cdn.com/content/v1/6491eb91bb711304dd556188/98633883-f9d3-4ea3-bfba-97b2f6bebb71/BaldisBasicsClassicRemastered_Screenshot+%281%29.png", link: "/gameview/baldisbasics.html" },
        ];

        const gameList = document.getElementById('game-list');
        const searchInput = document.getElementById('search-input');
        const noResults = document.getElementById('no-results');
        const filterContainer = document.getElementById('filter-container');
        
        // New elements for the collapse feature
        const collapsibleContent = document.getElementById('collapsible-content');
        const collapseToggle = document.getElementById('collapse-toggle');
        const collapseIcon = document.getElementById('collapse-icon');
        let isCollapsed = false;

        // State to track the active filter
        let currentCategory = 'All'; 

        /**
         * Toggles the visibility of the main header content (Logo, Search, and Filters).
         */
        function toggleHeaderCollapse() {
            if (isCollapsed) {
                // Expand
                collapsibleContent.classList.remove('collapsed');
                collapseIcon.classList.remove('rotate-180');
                collapseToggle.setAttribute('aria-expanded', 'true');
            } else {
                // Collapse
                collapsibleContent.classList.add('collapsed');
                collapseIcon.classList.add('rotate-180');
                collapseToggle.setAttribute('aria-expanded', 'false');
            }
            isCollapsed = !isCollapsed;
        }

        /**
         * Returns an array of unique game categories including 'All'.
         */
        function getUniqueCategories() {
            const categories = gamesData.map(game => game.category);
            // Use Set to ensure uniqueness and spread it back into an array
            return ['All', ...new Set(categories)]; 
        }

        /**
         * Renders the category filter buttons and attaches click handlers.
         */
        function renderFilters() {
            const categories = getUniqueCategories();
            filterContainer.innerHTML = categories.map(category => `
                <button 
                    data-category="${category}" 
                    class="filter-button px-4 py-2 rounded-full text-sm font-bold transition duration-150 shadow-lg 
                    ${currentCategory === category ? 'bg-secondary text-dark-bg' : 'bg-card-bg text-gray-300 hover:bg-primary/50 hover:text-white'}"
                >
                    ${category}
                </button>
            `).join('');

            // Attach event listeners to the new buttons
            document.querySelectorAll('.filter-button').forEach(button => {
                button.addEventListener('click', (event) => {
                    // Update state and refresh the UI
                    currentCategory = event.target.dataset.category;
                    renderFilters(); // Re-render buttons to update the active style
                    filterGames();  // Re-render games based on the new filter
                });
            });
        }

        /**
         * Generates the HTML card for a single game object.
         */
        function createGameCard(game) {
            return `
                <a href="${game.link}" class="game-card block bg-card-bg rounded-xl shadow-lg hover:shadow-2xl transition duration-300 ease-in-out transform hover:-translate-y-1 overflow-hidden group border border-gray-700 hover:border-primary">
                    <div class="h-40 overflow-hidden">
                        <img 
                            src="${game.image}" 
                            alt="${game.title} thumbnail" 
                            class="w-full h-full object-cover group-hover:scale-[1.03] transition duration-300"
                            onerror="this.onerror=null; this.src='https://placehold.co/400x250/0f172a/94a3b8?text=Image+Unavailable';"
                        >
                    </div>
                    <div class="p-5">
                        <span class="text-xs font-semibold uppercase tracking-wider text-secondary">${game.category}</span>
                        <h3 class="text-xl font-bold text-white mt-1 group-hover:text-primary transition duration-150">${game.title}</h3>
                        <p class="text-gray-400 text-sm mt-2">Click to play!</p>
                    </div>
                </a>
            `;
        }

        /**
         * Renders the filtered list of games.
         */
        function renderGames(gamesToRender) {
            if (gamesToRender.length === 0) {
                gameList.innerHTML = '';
                noResults.classList.remove('hidden');
            } else {
                noResults.classList.add('hidden');
                const cardsHtml = gamesToRender.map(createGameCard).join('');
                gameList.innerHTML = cardsHtml;
            }
        }

        /**
         * Filters games based on the search input value AND the selected category.
         */
        function filterGames() {
            const searchTerm = searchInput.value.toLowerCase().trim();
            
            const filteredGames = gamesData.filter(game => {
                // 1. Check if the game matches the currently selected category
                const categoryMatch = currentCategory === 'All' || game.category === currentCategory;
                
                // 2. Check if the game title matches the search term
                const searchMatch = game.title.toLowerCase().includes(searchTerm);
                
                // The game must match both criteria
                return categoryMatch && searchMatch;
            });

            renderGames(filteredGames);
        }
        
        // --- NEW FUNCTIONALITY START ---
        /**
         * Opens the site's index page in a new window using the about:blank URI.
         */
        function openInBlank() {
            // This assumes the index page is at the root of the site (e.g., '/') 
            // and the content will be loaded in the new window.
            const targetUrl = window.location.origin + '/index.html'; 
            
            // 1. Open a new window to 'about:blank'
            const blankWindow = window.open('about:blank', '_blank');

            if (blankWindow) {
                // 2. Write an iframe into the new window's document to load the target URL
                const iframeHtml = `
                    <!DOCTYPE html>
                    <html>
                    <head>
                        <title>Loading...</title>
                        <style>
                            /* Simple styling to make the iframe fill the whole page */
                            html, body { margin: 0; padding: 0; height: 100%; width: 100%; overflow: hidden; }
                            iframe { border: none; width: 100%; height: 100%; }
                        </style>
                    </head>
                    <body>
                        <iframe src="${targetUrl}" allowfullscreen></iframe>
                    </body>
                    </html>
                `;

                blankWindow.document.write(iframeHtml);
                blankWindow.document.close();
            } else {
                // In case of a pop-up blocker
                alert("The 'about:blank' window could not be opened. Please disable your pop-up blocker.");
            }
        }
        // --- NEW FUNCTIONALITY END ---


        // Initialize: Render filters and games on page load
        document.addEventListener('DOMContentLoaded', () => {
            renderFilters(); 
            filterGames(); // Initial render uses 'All' category and empty search term
            
            // Set up initial ARIA state for accessibility
            collapseToggle.setAttribute('aria-expanded', 'true');
            
            // --- NEW EVENT LISTENER ---
            // Event Listener: Attach the click handler for the about:blank link
            document.getElementById('blank-link').addEventListener('click', (event) => {
                event.preventDefault(); // Stop the default '#' link behavior
                openInBlank();
            });
        });

        // Event Listener: Filter games whenever the user types
        searchInput.addEventListener('input', filterGames);

        // Event Listener: Attach the click handler for the header collapse
        collapseToggle.addEventListener('click', toggleHeaderCollapse);

    </script>
</body>
</html>
